(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{235:function(e,n,a){"use strict";a.r(n);var t=a(28),s=Object(t.a)({},(function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h3",{attrs:{id:"moogoose-模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moogoose-模块"}},[e._v("#")]),e._v(" Moogoose 模块")]),e._v(" "),a("h4",{attrs:{id:"moogoose-odm-对象文档模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#moogoose-odm-对象文档模型"}},[e._v("#")]),e._v(" Moogoose ODM 对象文档模型")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("下载mongoose")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("npm i mongoose --save\n")])])])]),e._v(" "),a("li",[a("p",[e._v("引入mongoose")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("const mongoose = require('mongoose');\n")])])])]),e._v(" "),a("li",[a("p",[e._v("连接数据库")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('mongoose.connect("mongodb://127.0.0.1/my_test",{ useNewUrlParser: true })\n')])])])]),e._v(" "),a("li",[a("p",[e._v("数据库断开")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("mongoose.disconnect();\n")])])])]),e._v(" "),a("li",[a("p",[e._v("创建模式结构")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("var studentsSchema = mongoose.Schema({\n    name: String,\n    age: Number,\n    gender: { // 0 为女 1为男\n        type: Number,\n        default: 0\n    },\n    address: String\n})\n")])])])]),e._v(" "),a("li",[a("p",[e._v("创建model集合(如果集合名字为单数，mongoose会自动添加变成复数)")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('var StudentsModel = mongoose.model("student", studentsSchema);\n')])])])]),e._v(" "),a("li",[a("p",[e._v("创建数据 插入数据")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<modal>.create(\n    doc[s], \n    [functions(err[错误], data[插入成功的数据]){}]\n)\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("StudentsModel.create({\n    name: '张三',\n    age: 30,\n    gender: 1,\n    address: '北京'\n}, function(err) {\n    if(!err) {\n        console.log(\"数据创建成功！\");\n    }\n})\n")])])])]),e._v(" "),a("li",[a("p",[e._v("查询数据")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("find")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('<modal>.find(\n    conditions, // 查询条件 没有属性查所有\n    projections, // 投影 需要获取或隐藏的字段 \n        // 1. 对象{a: 1, b:0}; \n        // 2. 字符串 "a, -b"\n    options, // 查询条件 limit skip sort\n    callback // 回调函数\n)\n查询所有符合条件的文档，总会返回一个数组\n')])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('StudentsModel.find({\n    age: {\n        $lt: 25\n    },\n}, "name -_id", {\n    skip: 1,\n    limit: 2,\n    sort: {\n        age: 1\n    }\n}, function(err, docs) {\n    if(!err) {\n        console.log(docs)\n    }\n})\n')])])])]),e._v(" "),a("li",[a("p",[e._v("findOne 查询返回的结果是一个文档")])]),e._v(" "),a("li",[a("p",[e._v("findById 通过ID查询，不需要ObjectId")])])])]),e._v(" "),a("li",[a("p",[e._v("修改数据")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("update")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<modal>.update(\n    conditions, // 查询条件\n    doc, // 替换的对象\n    options, // 替换的选项 如multi\n    callback // 替换的结果回掉\n)\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("StudentsModel.update({\n    name: '王五'\n}, {\n    $set: {\n        age: 99\n    }\n}, function (err) {\n    if(!err) {\n        console.log(\"数据更新成功\");\n    }\n})\n")])])])]),e._v(" "),a("li",[a("p",[e._v("updateOne 只是替换一个")])]),e._v(" "),a("li",[a("p",[e._v("updateMany 替换多个")])])])]),e._v(" "),a("li",[a("p",[e._v("删除数据")]),e._v(" "),a("ul",[a("li",[e._v("remove")]),e._v(" "),a("li",[e._v("deleteOne")]),e._v(" "),a("li",[e._v("deleteMany")])])]),e._v(" "),a("li",[a("p",[e._v("统计数量")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("<modal>.countDocuments({}, function(err, count){})\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("StudentsModel.countDocuments({}, function(err, data){\n    if(!err) {\n        console.log(data);\n    }\n})\n")])])])]),e._v(" "),a("li",[a("p",[e._v("通过文档调用保存数据")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("var StudentsModel = mongoose.model(\"student\", studentsSchema);\nvar Studetns = new StudentsModel({\n    name: '韩梅梅',\n    gender: 1,\n    age: 29,\n    address: '海口'\n})\n\nStudetns.save(function(err){\n    if(!err) {\n        console.log(\"数据插入成功\");\n    }\n})\n")])])])]),e._v(" "),a("li",[a("p",[e._v("直接修改数据直接保存")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("StudentsModel.find({name: '王老五'}, function(err, docs) {\n    if(err) return;\n    docs[0].name = \"王老六\";\n    docs[0].save();\n})\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("StudentsModel.findOne({name: '王老六'}, function(err, doc) {\n    if(err) return;\n    doc.name = \"王老八\";\n    doc.save();\n})\n")])])])]),e._v(" "),a("li",[a("p",[e._v("查询结果转对象 toObject()")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("StudentsModel.findOne({name: '张三'}, function(err, doc) {\n    if(err) return;\n    doc = doc.toObject();\n    delete doc.age;\n    console.log(doc)\n})\n")])])])])])])}),[],!1,null,null,null);n.default=s.exports}}]);